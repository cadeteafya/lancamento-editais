<!doctype html><html lang="pt-br"><head>
<meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Lan√ßamento de editais</title>
<link rel="stylesheet" href="assets/style.css">
</head><body>
<div class="container">
  <div class="hero">√öltimos lan√ßamentos de editais em resid√™ncia m√©dica:</div>
  <div id="grid" class="grid"></div>
</div>
<script>
async function main(){
  const params = new URLSearchParams(location.search);
  const slug = params.get('slug');

  const data = await (await fetch('data/editais.json',{cache:'no-store'})).json();
  const item = data.find(x=>x.slug===slug);

  if(!item){
    document.getElementById('titulo').textContent = 'Edital n√£o encontrado';
    return;
  }

  document.getElementById('titulo').textContent =
    `Edital: ${item.display_title || item.nome}`;

  const cont = document.getElementById('blocos');

  // Usa 'secoes' (N colunas) ou cai no compat 'dados' como primeira se√ß√£o 2-col
  let secoes = Array.isArray(item.secoes) && item.secoes.length
    ? item.secoes
    : (item.dados && item.dados.length ? [{ titulo:'Resumo do edital', linhas:item.dados, cols:2 }] : []);

  const html = secoes.map((sec, idx) => {
    const isFirst = idx === 0; // primeira se√ß√£o = tabela 2 colunas

    // formato novo (headers/rows)
    if (Array.isArray(sec.rows) && sec.rows.length) {
      const headers = Array.isArray(sec.headers) ? sec.headers : [];
      const head = headers.length
        ? `<thead><tr>${headers.map(h=>`<th>${h}</th>`).join('')}</tr></thead>`
        : '';
      const body = `<tbody>${
        sec.rows.map(r=>`<tr>${r.map(c=>`<td>${c}</td>`).join('')}</tr>`).join('')
      }</tbody>`;

      // se for a primeira se√ß√£o mas ela j√° veio em formato N-col,
      // ainda assim usamos .table-2col s√≥ quando realmente for 2 colunas
      const cls = (isFirst && (sec.cols === 2)) ? 'table-2col' : 'table-n';
      return `
        <h2 style="margin:18px 0 10px">${sec.titulo}</h2>
        <table class="${cls}">${head}${body}</table>
      `;
    }

    // compat 2-col (linhas com etapa/data)
    const linhas = (sec.linhas||[]).map(r=>`<tr><td>${r.etapa}</td><td>${r.data}</td></tr>`).join('');
    const cls = isFirst ? 'table-2col' : 'table-n';
    return `
      <h2 style="margin:18px 0 10px">${sec.titulo||'Resumo do edital'}</h2>
      <table class="${cls}"><tbody>${linhas}</tbody></table>
    `;
  }).join('');

  cont.innerHTML = html || `<div class="meta">Sem informa√ß√µes de tabela.</div>`;

  const linkDiv = document.getElementById('linkOficial');
  if(item.link_banca){
    linkDiv.innerHTML =
      `üîó <strong>Link para o site oficial:</strong> ` +
      `<a href="${item.link_banca}" target="_blank" rel="noopener">${new URL(item.link_banca).hostname}</a>`;
  } else {
    linkDiv.textContent = '';
  }
}
main().catch(console.error);
</script>


</body></html>






